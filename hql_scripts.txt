create table u_item (movie_id int, movie_title string, release_date string, video_release_date string, imdb_link string, unknown tinyint, action tinyint, adventure tinyint, animation tinyint, children tinyint, comedy tinyint, crime tinyint, documentary tinyint, drama tinyint, fantasy tinyint, film_noir tinyint, horror tinyint, musical tinyint, mystery tinyint, romance tinyint, scifi tinyint, thriller tinyint, war tinyint, western tinyint) row format delimited fields terminated by '|' stored as textfile;


select movie_title, count(*) as user_rated 
from u_data 
join u_item
on u_data.movie_id = u_item.movie_id 
group by movie_title
order by user_rated desc
limit 5;

select movie_title, round(avg(rating), 2) as avg_rate from u_data join u_item on u_data.movie_id = u_item.movie_id group by movie_title;


# Get genre distribution
select sum(unknown) as unknown, sum(action) as action, sum(adventure) as adventure, sum(children) as children, sum(comedy) as comedy, sum(crime) as crime, sum(documentary) as documentary, sum(drama) as drama, sum(fantasy) as fantasy, sum(film_noir) as film_noir, sum(horror) as horror, sum(musical) as musical, sum(mystery) as mystery, sum(romance) as romance, sum(scifi) as scifi, sum(thriller) as thriller, sum(war) as war, sum(western) as westerm from u_item;
